<header class="fixed top-0 z-50 w-full bg-gradient-to-r from-primary to-black shadow-md">
  <div class="navbar container mx-auto px-2 sm:px-4">
    <div class="navbar-start">
      <div class="dropdown">
        <div tabindex="0" role="button" class="btn btn-ghost lg:hidden text-white mr-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h8m-8 6h16"
            />
          </svg>
        </div>

        <ul
          tabindex="0"
          class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-72 text-base-content"
        >
          @if (accountService.currentUser()) {
            <li><a routerLink="/members" routerLinkActive="active">Matches</a></li>
            <li><a routerLink="/lists" routerLinkActive="active">Lists</a></li>
            <li><a routerLink="/messages" routerLinkActive="active">Messages</a></li>
            <li *appHasRole="['Admin', 'Moderator']"><a routerLink="/admin">Admin</a></li>
          }

          @if (!accountService.currentUser()) {
            <li class="menu-title mt-2">Login</li>
            <li>
              <form #loginFormMobile="ngForm" (ngSubmit)="login()" class="flex flex-col gap-2 p-1">
                <input
                  [(ngModel)]="creds.email"
                  name="email"
                  type="text"
                  placeholder="Email"
                  class="input input-bordered w-full"
                />
                <input
                  [(ngModel)]="creds.password"
                  name="password"
                  type="password"
                  placeholder="Password"
                  class="input input-bordered w-full"
                />
                <button type="submit" class="btn btn-primary btn-sm w-full mt-2">
                  @if (loading()) {
                    <span class="loading loading-spinner loading-xs"></span>
                  }
                  Login
                </button>
              </form>
            </li>
          }
        </ul>
      </div>

      <a routerLink="/" class="flex items-center gap-2 text-white hover:text-accent transition">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="size-6 sm:size-7"
        >
          <path
            d="M4.5 6.375a4.125 4.125 0 1 1 8.25 0 4.125 4.125 0 0 1-8.25 0ZM14.25 8.625a3.375 3.375 0 1 1 6.75 0 3.375 3.375 0 0 1-6.75 0ZM1.5 19.125a7.125 7.125 0 0 1 14.25 0v.003l-.001.119a.75.75 0 0 1-.363.63 13.067 13.067 0 0 1-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 0 1-.364-.63l-.001-.122ZM17.25 19.128l-.001.144a2.25 2.25 0 0 1-.233.96 10.088 10.088 0 0 0 5.06-1.01.75.75 0 0 0 .42-.643 4.875 4.875 0 0 0-6.957-4.611 8.586 8.586 0 0 1 1.71 5.157v.003Z"
          />
        </svg>
        <span class="text-lg sm:text-2xl font-semibold uppercase tracking-widest">Dating App</span>
      </a>
    </div>

    <div class="navbar-center hidden lg:flex">
      <ul class="menu menu-horizontal px-1 text-white text-lg uppercase gap-1">
        @if (accountService.currentUser()) {
          <li>
            <a
              routerLink="/members"
              routerLinkActive="text-accent border-b-2 border-accent"
              [routerLinkActiveOptions]="{ exact: true }"
              >Matches</a
            >
          </li>
          <li>
            <a routerLink="/lists" routerLinkActive="text-accent border-b-2 border-accent">Lists</a>
          </li>
          <li>
            <a routerLink="/messages" routerLinkActive="text-accent border-b-2 border-accent"
              >Messages</a
            >
          </li>
          <li *appHasRole="['Admin', 'Moderator']">
            <a routerLink="/admin" routerLinkActive="text-accent border-b-2 border-accent">Admin</a>
          </li>
        }
      </ul>
    </div>

    <div class="navbar-end gap-2">
      @if (busyService.busyRequestCount() > 0) {
        <div class="mr-2">
          <span class="loading loading-spinner text-accent"></span>
        </div>
      }

      <div class="dropdown dropdown-end">
        <button tabindex="0" class="btn btn-ghost btn-sm sm:btn-md text-white">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-5 sm:size-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42"
            />
          </svg>
          <span class="hidden sm:inline text-xs uppercase">{{ selectedTheme() }}</span>
        </button>
        <ul
          tabindex="0"
          class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52"
        >
          @for (theme of themes; track $index) {
            <li (click)="handleSelectTheme(theme)">
              <a>{{ theme }}</a>
            </li>
          }
        </ul>
      </div>

      @if (accountService.currentUser(); as user) {
        <div class="dropdown dropdown-end">
          <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
            <div class="w-8 sm:w-10 rounded-full border border-white">
              <img [src]="user?.imageUrl || '/user.png'" alt="User" />
            </div>
          </div>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52 text-base-content"
          >
            <li><a class="justify-between" routerLink="members/{{ user.id }}">Edit Profile</a></li>
            <li><a (click)="logout()">Logout</a></li>
          </ul>
        </div>
      } @else {
        <form #loginForm="ngForm" (ngSubmit)="login()" class="hidden lg:flex items-center gap-2">
          <input
            [(ngModel)]="creds.email"
            name="email"
            type="text"
            class="input input-sm input-bordered w-40"
            placeholder="Email"
          />
          <input
            [(ngModel)]="creds.password"
            name="password"
            type="password"
            class="input input-sm input-bordered w-40"
            placeholder="Password"
          />
          <button type="submit" class="btn btn-sm btn-primary">
            @if (loading()) {
              <span class="loading loading-spinner loading-xs mr-1"></span>
            }
            Login
          </button>
        </form>
      }
    </div>
  </div>
</header>
